:root{
  --bg:#020617;
  --card:#020819;
  --border:#1e293b;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --scroll:#1e293b;

  /* densidade (compacto) */
  --header-h:62px;
  --gap:10px;
  --pad:10px;

  /* alturas mínimas p/ evitar corte nos gráficos (desktop) */
  --chart-min:220px;
  --chart-min-serv:300px;
}

*{ box-sizing:border-box; }

html,body{
  height:100%;
  margin:0;
  font-family:Inter,system-ui,-apple-system,Segoe UI,sans-serif;
  color:var(--text);
  background:
    radial-gradient(1000px 600px at 0% 0%, #1d4ed822, transparent),
    radial-gradient(900px 560px at 100% 0%, #38bdf822, transparent),
    linear-gradient(to bottom, #020617, #020617);
}

/* ✅ Desktop: tela “sem rolagem”.
   Mobile: a gente libera scroll por media query (mais abaixo). */
body{
  height:100vh;
  overflow:hidden;
}

/* ===== Header ===== */
header{
  height:var(--header-h);
  padding:10px 14px;
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  backdrop-filter:blur(18px);
  background:#020617ee;
  position:sticky; top:0; z-index:10;
}

.brand{ display:flex; align-items:center; gap:10px; min-width:0; }
.logo{
  width:34px;height:34px;border-radius:12px; display:grid;place-items:center;
  font-weight:800; font-size:15px; color:#020617;
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  box-shadow:0 0 0 1px #0ea5e944,0 10px 30px #0ea5e94d;
}
.brand-text-title{ font-size:15px; font-weight:800; letter-spacing:.03em; line-height:1.1; }
.brand-text-sub{
  font-size:11px; color:var(--muted);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  max-width:52vw;
}
.pill-status{
  font-size:10px;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid #1e293b;
  background:#020617;
  color:var(--muted);
  white-space:nowrap;
}

/* ===== Main ===== */
main{
  height:calc(100vh - var(--header-h));
  padding:var(--pad);
  display:flex;
  flex-direction:column;
  gap:var(--gap);
  overflow:hidden;
  min-height:0;
}

/* ===== KPIs ===== */
.top-grid{
  display:grid;
  grid-template-columns:repeat(4,minmax(0,1fr));
  gap:var(--gap);
  min-height:0;
}

.kpi{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:8px 10px;
  display:flex;
  flex-direction:column;
  gap:2px;
  min-height:56px;
}
.kpi-label{ font-size:10px; text-transform:uppercase; letter-spacing:.12em; color:var(--muted); }
.kpi-value{ font-size:16px; font-weight:800; line-height:1.1; }
.kpi-foot{ font-size:10px; color:var(--muted); }

/* ===== Layout principal: mapa esquerda, direita ===== */
.layout{
  flex:1;
  min-height:0;
  display:grid;
  grid-template-columns:minmax(0, 2.1fr) minmax(360px, 1.2fr);
  gap:var(--gap);
  align-items:stretch;
  overflow:hidden;
}

/* ===== Card base ===== */
.card-pane{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-height:0;
}

.pane-header{
  padding:8px 10px;
  border-bottom:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:10px;
}
.pane-title{ font-weight:800; font-size:13px; line-height:1.1; }
.pane-sub{ font-size:11px; color:var(--muted); margin-top:2px; line-height:1.2; }

/* ===== Map ===== */
#map{
  flex:1;
  min-height:0;
  height:100%;
}
.leaflet-container{ background:#020617; }

.demanda-marker-wrapper{
  display:flex; align-items:center; justify-content:center;
  width:26px;height:26px; border-radius:999px;
  border:2px solid #020617;
  box-shadow:0 0 0 1px #02061780,0 0 14px #000000aa;
  font-size:14px;
}

/* ===== Botões ===== */
.actions{ display:flex; flex-wrap:wrap; gap:6px; align-items:center; }
.btn{
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
  border-radius:999px;
  padding:6px 10px;
  font-size:11px;
  cursor:pointer;
  user-select:none;
}
.btn:hover{ background:#020a1f; }
.btn.is-on{
  border-color:#38bdf8aa;
  box-shadow:0 0 0 1px #38bdf833,0 0 0 4px #38bdf811;
  background:#051125;
}

/* ===== Coluna direita ===== */
.right-col{
  display:flex;
  flex-direction:column;
  gap:var(--gap);
  min-height:0;
  overflow:hidden; /* desktop */
}

/* ===== Charts ===== */
.hint{
  font-size:10px;
  color:var(--muted);
  padding:6px 10px 0;
  line-height:1.2;
}

.right-col > section.card-pane:first-child{
  flex:1;
  min-height:0;
}

/* Desktop: grid 2+1 com scroll interno */
.charts-body{
  flex:1;
  min-height:0;
  padding:8px 10px 12px;
  display:grid;
  gap:10px;

  grid-template-columns:1fr 1fr;
  grid-template-rows:minmax(var(--chart-min), 1fr) minmax(var(--chart-min-serv), 1.2fr);

  overflow:auto;
  scrollbar-width:thin;
  scrollbar-color:var(--scroll) transparent;
}
.charts-body::-webkit-scrollbar{ width:8px; height:8px; }
.charts-body::-webkit-scrollbar-thumb{ background:var(--scroll); border-radius:999px; }

.chart-card{
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.07);
  border-radius: 14px;
  overflow:hidden;

  display:flex;
  flex-direction:column;
  min-height:0;
}

.charts-body .chart-card:not(.half){
  grid-column:1 / -1;
}

.chart-title{
  padding:8px 10px;
  border-bottom:1px solid rgba(255,255,255,.07);
  font-size:12px;
  font-weight:800;
  color:var(--text);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
  flex:0 0 auto;
}
.chart-sub{
  font-size:11px;
  color:var(--muted);
  font-weight:600;
}

.chart{
  flex:1 1 auto;
  min-height:var(--chart-min);
  width:100%;
  height:100%;
}
#chartServico{
  min-height:var(--chart-min-serv);
}

/* ===== Lista ===== */
.filter-row{
  padding:10px;
  border-bottom:1px solid var(--border);
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:end;
}
.filter-row > div{
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:11px;
  color:var(--muted);
  min-width:180px;
  flex:1;
}
.filter-row select,
.filter-row input{
  width:100%;
  padding:8px 10px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.10);
  background:#020617;
  color:var(--text);
  outline:none;
}
.filter-row select:focus,
.filter-row input:focus{
  border-color:#38bdf8aa;
  box-shadow:0 0 0 4px #38bdf811;
}

.list-body{
  flex:1;
  min-height:0;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.list-body table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}
.list-body thead th{
  position:sticky; top:0;
  background:#020819;
  border-bottom:1px solid rgba(255,255,255,.08);
  text-align:left;
  padding:10px;
  color:var(--muted);
  font-size:11px;
  z-index:2;
}
.list-body tbody td{
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,.06);
  vertical-align:top;
}
.list-body tbody tr:hover{
  background:rgba(56,189,248,.06);
}

/* =========================================================
   ✅ MOBILE “de verdade”: mesma estética, só que sem travar
   ========================================================= */
@media (max-width:980px){
  /* libera rolagem da página (evita layout esmagado) */
  body{
    height:auto;
    min-height:100dvh;
    overflow:auto;
  }
  main{
    height:auto;
    min-height:calc(100dvh - var(--header-h));
    overflow:visible;
  }

  /* KPIs iguais (sem carrossel): 2x2 */
  .top-grid{
    grid-template-columns:repeat(2, minmax(0,1fr));
    overflow:visible;
  }

  /* Layout vira coluna, com alturas “boas” */
  .layout{
    display:flex;
    flex-direction:column;
    overflow:visible;
  }

  /* MAPA com altura bonita no celular */
  .layout > .card-pane:first-child #map{
    height:56dvh;
    min-height:340px;
  }

  /* direita deixa crescer */
  .right-col{
    overflow:visible;
  }
  .right-col > section.card-pane:first-child{
    flex:unset;
  }

  /* Charts sem scroll interno (evita “apertado” no mobile) */
  .charts-body{
    display:flex;
    flex-direction:column;
    overflow:visible;
    padding-bottom:12px;
  }

  /* alturas mais “Power BI” no celular */
  .chart{
    min-height:clamp(220px, 34dvh, 360px);
  }
  #chartServico{
    min-height:clamp(260px, 40dvh, 420px);
  }

  /* Lista: mantém scroll só na tabela (normal no mobile) */
  .list-body{
    overflow:auto;
  }
  .list-body table{
    min-width:820px; /* evita esmagar colunas (rola pro lado só na tabela) */
  }
}

/* ===== Ajustes finos mobile pequeno ===== */
@media (max-width:520px){
  :root{
    --pad:8px;
    --gap:8px;
  }

  header{ padding:10px 12px; }
  .brand-text-sub{ max-width:46vw; }

  .pane-sub{ display:none; }
  .hint{ display:none; }

  /* filtros em 1 coluna, mais fácil no celular */
  .filter-row{ gap:8px; }
  .filter-row > div{ min-width:0; flex:1 1 100%; }

  /* mapa um pouco menor em telas bem pequenas */
  .layout > .card-pane:first-child #map{
    height:52dvh;
    min-height:300px;
  }
}

/* ===== Altura baixa: ainda garante scroll ===== */
@media (max-height:760px){
  body{ overflow:auto; }
  main{
    height:auto;
    min-height:calc(100vh - var(--header-h));
    overflow:visible;
  }
  .layout{ overflow:visible; }
  .right-col{ overflow:visible; }
}
